<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_102) on Sat Nov 12 16:30:09 PST 2016 -->
<title>org.fpe4j</title>
<meta name="date" content="2016-11-12">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="org.fpe4j";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Package</li>
<li><a href="../../org/fpe4j/ifx/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?org/fpe4j/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.fpe4j</h1>
<div class="docSummary">
<div class="block">This package implements the two methods for format-preserving encryption
 specified in NIST Special Publication 800-38G, Recommendation for Block
 Cipher Modes of Operation: Methods for Format-Preserving Encryption, as well
 as the FFX mechanism and A2 and A10 parameter sets for format-preserving
 encryption described in <a href=
 "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.304.1736&rep=rep1&type=pdf">The
 FFX Mode of Operation for Format-Preserving Encryption</a>, by Mihir Bellare,
 Phillip Rogaway, and Terence Spies.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FFX.ArithmeticFunction.html" title="interface in org.fpe4j">FFX.ArithmeticFunction</a></td>
<td class="colLast">
<div class="block">The arithmetic functions for the [+] and [-] operations in the Feistel
 rounds.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/FFX.FFXParameters.html" title="interface in org.fpe4j">FFX.FFXParameters</a></td>
<td class="colLast">
<div class="block">FFX parameter set.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FFX.RoundCounter.html" title="interface in org.fpe4j">FFX.RoundCounter</a></td>
<td class="colLast">
<div class="block">Function to determine the number of Feistel rounds.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/FFX.RoundFunction.html" title="interface in org.fpe4j">FFX.RoundFunction</a></td>
<td class="colLast">
<div class="block">Pseudorandom function for Feistel rounds.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FFX.SplitFunction.html" title="interface in org.fpe4j">FFX.SplitFunction</a></td>
<td class="colLast">
<div class="block">Function to determine where to split input arrays.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/A10Parameters.html" title="class in org.fpe4j">A10Parameters</a></td>
<td class="colLast">
<div class="block">FFX parameter set for the A10 algorithm defined in <a href=
 "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.304.1736&rep=rep1&type=pdf">The
 FFX Mode of Operation for Format-Preserving Encryption</a>, by Mihir Bellare,
 Phillip Rogaway, and Terence Spies.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/A10Test.html" title="class in org.fpe4j">A10Test</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the A10Parameters class.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/A2Parameters.html" title="class in org.fpe4j">A2Parameters</a></td>
<td class="colLast">
<div class="block">FFX parameter set for the A2 algorithm defined in <a href=
 "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.304.1736&rep=rep1&type=pdf">The
 FFX Mode of Operation for Format-Preserving Encryption</a>, by Mihir Bellare,
 Phillip Rogaway, and Terence Spies.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/A2Test.html" title="class in org.fpe4j">A2Test</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the A2Parameters class.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/CiphersTest.html" title="class in org.fpe4j">CiphersTest</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the Ciphers class.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/Common.html" title="class in org.fpe4j">Common</a></td>
<td class="colLast">
<div class="block">Common functions used by FF1 and FF3.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/CommonTest.html" title="class in org.fpe4j">CommonTest</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the Common class.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/ConstantsTest.html" title="class in org.fpe4j">ConstantsTest</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the Constants class.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FF1.html" title="class in org.fpe4j">FF1</a></td>
<td class="colLast">
<div class="block">Implementation of the FF1 method for format-preserving encryption defined in
 NIST SP 800-38G.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/FF1PaddingTest.html" title="class in org.fpe4j">FF1PaddingTest</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FF1Parameters.html" title="class in org.fpe4j">FF1Parameters</a></td>
<td class="colLast">
<div class="block">FFX parameter set for the FF1 algorithm defined in NIST SP 800-38G.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/FF1Test.html" title="class in org.fpe4j">FF1Test</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the FF1 class.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FF3.html" title="class in org.fpe4j">FF3</a></td>
<td class="colLast">
<div class="block">Implementation of the FF3 method for format-preserving encryption defined in
 NIST SP 800-38G.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/FF3Parameters.html" title="class in org.fpe4j">FF3Parameters</a></td>
<td class="colLast">
<div class="block">FFX parameter set for the FF3 algorithm defined in NIST SP 80-38G.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FF3Test.html" title="class in org.fpe4j">FF3Test</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the FF3 class.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/FFX.html" title="class in org.fpe4j">FFX</a></td>
<td class="colLast">
<div class="block">Implementation of the FFX algorithm described in <a href=
 "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.304.1736&rep=rep1&type=pdf">The
 FFX Mode of Operation for Format-Preserving Encryption</a>, by Mihir Bellare,
 Phillip Rogaway, and Terence Spies.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FFXConformanceTest.html" title="class in org.fpe4j">FFXConformanceTest</a></td>
<td class="colLast">
<div class="block">JUnit test cases for conformance with NIST SP 800-38G and the NIST sample
 data provided at <a href=
 "http://csrc.nist.gov/groups/ST/toolkit/examples.html">http://csrc.nist.gov/groups/ST/toolkit/examples.html</a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../org/fpe4j/FFXTest.html" title="class in org.fpe4j">FFXTest</a></td>
<td class="colLast">
<div class="block">JUnit test cases for the FFX class.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/NistConformanceTest.html" title="class in org.fpe4j">NistConformanceTest</a></td>
<td class="colLast">
<div class="block">JUnit test cases for conformance with the NIST sample data provided at
 <a href=
 "http://csrc.nist.gov/groups/ST/toolkit/examples.html">http://csrc.nist.gov/groups/ST/toolkit/examples.html</a>.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Enum Summary table, listing enums, and an explanation">
<caption><span>Enum Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Enum</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../org/fpe4j/FFX.FeistelMethod.html" title="enum in org.fpe4j">FFX.FeistelMethod</a></td>
<td class="colLast">
<div class="block">Types of Feistel methods</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package org.fpe4j Description">Package org.fpe4j Description</h2>
<div class="block">This package implements the two methods for format-preserving encryption
 specified in NIST Special Publication 800-38G, Recommendation for Block
 Cipher Modes of Operation: Methods for Format-Preserving Encryption, as well
 as the FFX mechanism and A2 and A10 parameter sets for format-preserving
 encryption described in <a href=
 "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.304.1736&rep=rep1&type=pdf">The
 FFX Mode of Operation for Format-Preserving Encryption</a>, by Mihir Bellare,
 Phillip Rogaway, and Terence Spies.
 
 <p>
 The implementations focus on conformance, rather than on security or
 performance, and as such they may not be suitable for real-world use with
 sensitive data.
 
 <p>
 Both methods FF1 and FF3 are implemented in standalone classes as well as in
 FFX parameter sets. (Note that the FF2 method was not selected for the March
 2016 publication of NIST SP 800-38G.)
 
 <p>
 Common block cipher modes of encryption, such as AES, take fixed-length
 blocks of plaintext bytes as input and produce blocks of the same size
 ciphertext as output. Padding and block chaining modes allow block ciphers to
 be used to encrypt streams of data of arbitrary length.
 
 <p>
 In some circumstances, e.g. when working with legacy environments, it is
 necessary to produce ciphertext in the same format and length, using the same
 set of symbols as the original plaintext. For example, a payment account
 number (PAN) consists of up to 19 decimal digits, with the first 6 digits
 used to identify the payment scheme and issuing bank, and the final digit
 used as a checksum using the Luhn algorithm. A card payment processor may
 need to encrypt these PANs in a way that the ciphertext retains some or all
 of the original attributes of the plaintext, so that systems designed to
 process the plaintext may also process the ciphertext.
 
 <p>
 Format-preserving encryption (FPE) methods take strings of symbols as
 plaintext input, and produce ciphertext output of the same length as the
 input using the same set of symbols as the input. For the example above, this
 would allow a card payment processor to encrypt PANs yet retain the same
 format and structure in the ciphertext as in the plaintext.
 
 <h1>Standalone FF1 and FF3 Usage</h1>
 
 <p>
 The FF1 and FF3 methods operate on several parameters:
 <dl>
 <dd>radix, the range of integer symbols [0..radix-1] used in the input and
 output
 <dd>K, an AES encryption key
 <dd>T, an array of bytes used as an arbitrary "tweak," which is not
 necessarily secret but which extends and modifies the key
 <dd>X, an array of integer symbols, each within the range [0..radix-1]
 </dl>
 FF3 uses a fixed-length 8 byte tweak, but FF1 accepts an additional
 parameter:
 <dl>
 <dd>maxTlen, the maximum length of T; any length of T in the range
 [0..maxTlen] is accepted
 </dl>
 Both FF1 and FF3 output arrays of integer symbols, with length equal to the
 input length, and with each symbol in the range [0..radix-1].
 
 <h1>FFX and FFXParameter Usage</h1>
 
 <p>
 The generic FFX method takes a set of parameters as input and uses those
 parameters to implement a specific format-preserving encryption algorithm. To
 use FFX, the caller must implement a complete set of parameters to define a
 specific algorithm, notably a round function for transformations in the
 Feistel rounds.
 
 <p>
 An FFX instance may be instantiated by supplying individual parameters, which
 follows the FFX specification, or by supplying an FFXParameters object, which
 provides the additional flexibility necessary to implement FF3 or other FFX
 variations with custom arithmetic functions.
 
 <p>
 This implementation includes FFX parameter sets for the FF1 and FF3
 algorithms, as well as for the A2 and A10 algorithms defined by Bellare,
 Rogaway, and Spies.
 
 <p>
 The A2 algorithm operates on arrays of 8 to 128 boolean values, implemented
 as arrays of integers with a radix of 2. The A10 algorithm operates on arrays
 of 4 to 36 decimal values, implemented as arrays of integers with a radix of
 10. Both A2 and A10 accept tweak arrays of arbitrary length.
 
 <h1>Usage notes for all algorithms</h1>
 
 <p>
 It is up to the caller to convert between arbitrary data formats, e.g.
 character-based data, and the arrays of integers that the FF1 and FF3
 functions use for plaintext and ciphertext input and output. For example, a
 caller might convert input using the symbols [0123456789BCDFGHJKLMNPQRSTVWXZ]
 (i.e. the character set for the Natural Area Code) into the integer symbols
 [0..29], and reverse the conversion using the output.
 
 <p>
 All these methods of format-preserving encryption operate on uniform arrays
 of symbols where each symbol is in the same range. They do not preserve data
 formats where the set of symbols varies depending on the position within the
 input, such as a license plate number of one decimal digit followed by three
 upper case letters followed by three decimal digits. If necessary, the caller
 may transform such input into uniform symbols, then reverse the
 transformation to restore the original formatting.
 
 <h1>Notes on the Implementation</h1>

 <p>
 The standalone FF1 and FF3 implementations follow NIST SP 800-38G as
 literally as possible, with concessions where needed to represent the
 concepts in Java. In general, we forego optimizations in favor of a closer
 match between the code and NIST SP 800-38G. We do, however, make some
 concessions to readability where a direct interpretation of NIST SP 800-38G
 would produce verbose code that would be hard to read.
 
 <p>
 Likewise, the FFX implementation and A2 and A10 parameter sets follow
 Bellare, Rogaway, and Spies as closely as possible, with concessions where
 needed in the implementation in Java and for readability, but without
 optimizations.
 
 <p>
 To ensure compliance with the original specifications, we validate all inputs
 as specified, and throw exceptions as appropriate for invalid input.
 
 <h1>Naming</h1>

 <p>
 This implementation focuses on conformance with the algorithms defined in the
 specifications, with naming and structure closely aligned to the definitions
 in the specifications. As such, variable names in the code defy Java naming
 conventions in favor of the naming conventions used in the specifications.
 
 <p>
 So, for example, we use "x" to represent an integer and "X" to represent an
 array of integers or bytes (i.e. bits), even though this does not follow the
 Java conventions. We do, however, follow the Java conventions on
 capitalization of public class members, so e.g. minlen in NIST SP 800-38G is
 MINLEN, as a public static final member.
 
 <p>
 Method names, likewise, follow standard Java naming conventions, so "PRF(X)"
 in NIST SP 800-38G becomes "prf(X)" in the implementation.
 
 <p>
 The specifications use mathematical symbols for some of their notations,
 which require alternative naming in Java. In the implementation, these are
 replaced with descriptive method names. So, for example, the notation
 "&lfloor;x&rfloor;" becomes "floor(x)" in the implementation.
 
 <p>
 In some places, the specifications use superscripts and subscripts to specify
 additional parameters. So, for example, "STR<sup>m</sup><sub>radix</sub>(x)"
 becomes "str(x,radix,m)" in the implementation.
 
 <h1>Data Types</h1>
 
 <p>
 NIST SP 800-38G is written in terms of abstract data types, for which we have
 chosen specific Java types in the implementation.
 
 <p>
 We use arrays of bytes in place of the bit string type described in NIST SP
 800-38G. This implies that bit strings must have a length that is a multiple
 of 8 bits, but this is consistent with NIST SP 800-38G. (In fact, NIST SP
 800-38G may have been clearer if it were written in terms of bytes rather
 than bits -- see ERRATA.txt.)
 
 <p>
 We implement the numeral string in NIST SP 800-38G as an array of integers.
 The range of values for numerals in NIST SP 800-38G is 0..2<sup>radix</sup>,
 i.e. zero through 2<sup>2</sup>..2<sup>16</sup>, so all the values may be
 represented using 32-bit two's-compliment Java integers.
 
 <p>
 Integers in NIST SP 800-38G are implicitly non-negative whole numbers of
 arbitrary size, so we represent them using the BigInteger class.
 
 <p>
 As in NIST SP 800-38G, a block is a bit string (i.e. byte string) whose
 length is the block size of the block cipher (i.e. 128 bits or 16 bytes). We
 represent these as arrays of multiples of 16 bytes, without any special type.
 Note that the block size for AES, which is the approved block cipher, is 128
 bits regardless of the key size.
 
 <p>
 As described in NIST SP 800-38G, a block string is an array of bits (i.e.
 bytes) whose length is a multiple of the block size of the block cipher. we
 represent this as an array of bytes with a length that is a multiple of 16
 bytes, again without any special type.
 
 <h1>Native Functions</h1>
 
 <p>
 Some of the functions described in NIST SP 800-38G have native
 implementations in the Java language and standard libraries. Where
 appropriate, we have used these native implementations rather than
 re-implementing the functions.
 
 <p>
 Instead of implementing new LEN(X) functions for bit strings and numeral
 strings, we use the length field of the array type. For byte strings the
 length field is the BYTELEN(X) value, and the value of LEN(X) is X.length *
 8. (Again, there is an assumption in NIST SP 800-38G that bit strings are
 multiples of 8 bits.)
 
 <p>
 Instead of the mod calculation described in NIST SP 800-38G, we use the
 Math.floorMod(int) and BigInteger.mod(BigInteger) methods.
 
 <p>
 The bit string conversion in NIST SP 800-38G is only used with constant
 inputs, so we sometimes use inline constants in place of the function where
 this can improve readability.
 
 <p>
 The PRF(X) function used in FF1 is an implementation of the AES CBC mode
 without padding, followed by the extraction of the final block of the cipher.
 We have provided both the direct implementation of the PRF(X) function as
 Ciphers.prf(X) and an implementation that uses an AES Cipher object in
 Ciphers.prf2(X).
 
 <h1>JUnit Tests</h1>
 
 <p>
 The JUnit tests are written to validate inputs and outputs using the sample
 data for FF1 and FF3 provided by NIST, as well as to provide code coverage
 and to fully exercise the functions.</div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Package</li>
<li><a href="../../org/fpe4j/ifx/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?org/fpe4j/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
